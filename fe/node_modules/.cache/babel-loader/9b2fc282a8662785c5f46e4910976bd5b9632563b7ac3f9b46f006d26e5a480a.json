{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef } from \"react\";\nexport function useChessSocket(roomId, onUpdateBoard) {\n  _s();\n  const ws = useRef();\n  const playerColor = useRef(\"white\");\n  useEffect(() => {\n    ws.current = new WebSocket(\"ws://localhost:8765\");\n    ws.current.onopen = () => {\n      var _ws$current;\n      (_ws$current = ws.current) === null || _ws$current === void 0 ? void 0 : _ws$current.send(JSON.stringify({\n        type: \"join\",\n        room: roomId\n      }));\n    };\n    ws.current.onmessage = event => {\n      const data = JSON.parse(event.data);\n      if (data.type === \"state\") {\n        playerColor.current = data.color;\n        const fen = data.fen;\n        const turn = fen.split(\" \")[1] === \"w\" ? \"white\" : \"black\";\n        onUpdateBoard(fen, turn);\n      } else if (data.type === \"move\") {\n        const fen = data.fen;\n        const turn = fen.split(\" \")[1] === \"w\" ? \"white\" : \"black\";\n        onUpdateBoard(fen, turn);\n      } else if (data.type === \"error\") {\n        alert(data.msg);\n      }\n    };\n    return () => {\n      var _ws$current2;\n      (_ws$current2 = ws.current) === null || _ws$current2 === void 0 ? void 0 : _ws$current2.close();\n    };\n  }, [roomId]);\n  const sendMove = move => {\n    var _ws$current3;\n    (_ws$current3 = ws.current) === null || _ws$current3 === void 0 ? void 0 : _ws$current3.send(JSON.stringify({\n      type: \"move\",\n      room: roomId,\n      move\n    }));\n  };\n  return {\n    sendMove,\n    playerColor: playerColor.current\n  };\n}\n_s(useChessSocket, \"1umNfJB1tQJSYnIRTgjvu5NMZw4=\");","map":{"version":3,"names":["useEffect","useRef","useChessSocket","roomId","onUpdateBoard","_s","ws","playerColor","current","WebSocket","onopen","_ws$current","send","JSON","stringify","type","room","onmessage","event","data","parse","color","fen","turn","split","alert","msg","_ws$current2","close","sendMove","move","_ws$current3"],"sources":["C:/Users/User/PycharmProjects/Chess/fe/src/components/useChessSocket.ts"],"sourcesContent":["import { useEffect, useRef } from \"react\";\n\nexport function useChessSocket(roomId: string, onUpdateBoard: (fen: string, turn: \"white\" | \"black\") => void) {\n  const ws = useRef<WebSocket>();\n  const playerColor = useRef<\"white\" | \"black\">(\"white\");\n\n  useEffect(() => {\n    ws.current = new WebSocket(\"ws://localhost:8765\");\n\n    ws.current.onopen = () => {\n      ws.current?.send(JSON.stringify({ type: \"join\", room: roomId }));\n    };\n\n    ws.current.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      if (data.type === \"state\") {\n        playerColor.current = data.color;\n        const fen = data.fen;\n        const turn = fen.split(\" \")[1] === \"w\" ? \"white\" : \"black\";\n        onUpdateBoard(fen, turn);\n      } else if (data.type === \"move\") {\n        const fen = data.fen;\n        const turn = fen.split(\" \")[1] === \"w\" ? \"white\" : \"black\";\n        onUpdateBoard(fen, turn);\n      } else if (data.type === \"error\") {\n        alert(data.msg);\n      }\n    };\n\n    return () => {\n      ws.current?.close();\n    };\n  }, [roomId]);\n\n  const sendMove = (move: string) => {\n    ws.current?.send(JSON.stringify({ type: \"move\", room: roomId, move }));\n  };\n\n  return { sendMove, playerColor: playerColor.current };\n}\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAEzC,OAAO,SAASC,cAAcA,CAACC,MAAc,EAAEC,aAA6D,EAAE;EAAAC,EAAA;EAC5G,MAAMC,EAAE,GAAGL,MAAM,CAAY,CAAC;EAC9B,MAAMM,WAAW,GAAGN,MAAM,CAAoB,OAAO,CAAC;EAEtDD,SAAS,CAAC,MAAM;IACdM,EAAE,CAACE,OAAO,GAAG,IAAIC,SAAS,CAAC,qBAAqB,CAAC;IAEjDH,EAAE,CAACE,OAAO,CAACE,MAAM,GAAG,MAAM;MAAA,IAAAC,WAAA;MACxB,CAAAA,WAAA,GAAAL,EAAE,CAACE,OAAO,cAAAG,WAAA,uBAAVA,WAAA,CAAYC,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC;QAAEC,IAAI,EAAE,MAAM;QAAEC,IAAI,EAAEb;MAAO,CAAC,CAAC,CAAC;IAClE,CAAC;IAEDG,EAAE,CAACE,OAAO,CAACS,SAAS,GAAIC,KAAK,IAAK;MAChC,MAAMC,IAAI,GAAGN,IAAI,CAACO,KAAK,CAACF,KAAK,CAACC,IAAI,CAAC;MACnC,IAAIA,IAAI,CAACJ,IAAI,KAAK,OAAO,EAAE;QACzBR,WAAW,CAACC,OAAO,GAAGW,IAAI,CAACE,KAAK;QAChC,MAAMC,GAAG,GAAGH,IAAI,CAACG,GAAG;QACpB,MAAMC,IAAI,GAAGD,GAAG,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,GAAG,OAAO,GAAG,OAAO;QAC1DpB,aAAa,CAACkB,GAAG,EAAEC,IAAI,CAAC;MAC1B,CAAC,MAAM,IAAIJ,IAAI,CAACJ,IAAI,KAAK,MAAM,EAAE;QAC/B,MAAMO,GAAG,GAAGH,IAAI,CAACG,GAAG;QACpB,MAAMC,IAAI,GAAGD,GAAG,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,GAAG,OAAO,GAAG,OAAO;QAC1DpB,aAAa,CAACkB,GAAG,EAAEC,IAAI,CAAC;MAC1B,CAAC,MAAM,IAAIJ,IAAI,CAACJ,IAAI,KAAK,OAAO,EAAE;QAChCU,KAAK,CAACN,IAAI,CAACO,GAAG,CAAC;MACjB;IACF,CAAC;IAED,OAAO,MAAM;MAAA,IAAAC,YAAA;MACX,CAAAA,YAAA,GAAArB,EAAE,CAACE,OAAO,cAAAmB,YAAA,uBAAVA,YAAA,CAAYC,KAAK,CAAC,CAAC;IACrB,CAAC;EACH,CAAC,EAAE,CAACzB,MAAM,CAAC,CAAC;EAEZ,MAAM0B,QAAQ,GAAIC,IAAY,IAAK;IAAA,IAAAC,YAAA;IACjC,CAAAA,YAAA,GAAAzB,EAAE,CAACE,OAAO,cAAAuB,YAAA,uBAAVA,YAAA,CAAYnB,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC;MAAEC,IAAI,EAAE,MAAM;MAAEC,IAAI,EAAEb,MAAM;MAAE2B;IAAK,CAAC,CAAC,CAAC;EACxE,CAAC;EAED,OAAO;IAAED,QAAQ;IAAEtB,WAAW,EAAEA,WAAW,CAACC;EAAQ,CAAC;AACvD;AAACH,EAAA,CArCeH,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}