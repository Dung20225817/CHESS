{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef } from \"react\";\nexport const useChessSocket = (roomId, onMove) => {\n  _s();\n  const wsRef = useRef(null);\n  useEffect(() => {\n    const socket = new WebSocket(\"ws://localhost:8765\"); // đổi thành IP server trong LAN nếu cần\n    wsRef.current = socket;\n    socket.onopen = () => {\n      console.log(\"Connected to server\");\n      socket.send(JSON.stringify({\n        type: \"join\",\n        room: roomId\n      }));\n    };\n    socket.onmessage = event => {\n      const data = JSON.parse(event.data);\n      if (data.type === \"state\" || data.type === \"move\") {\n        if (data.fen) onMove(data.fen);\n      } else if (data.type === \"error\") {\n        alert(data.msg);\n      }\n    };\n    socket.onclose = () => console.log(\"Disconnected\");\n    return () => socket.close();\n  }, [roomId, onMove]);\n  const sendMove = move => {\n    if (wsRef.current && wsRef.current.readyState === WebSocket.OPEN) {\n      wsRef.current.send(JSON.stringify({\n        type: \"move\",\n        room: roomId,\n        move\n      }));\n    }\n  };\n  return {\n    sendMove\n  };\n};\n_s(useChessSocket, \"QdfxMzvzcAhNcX9HkNqVUNbfVRs=\");","map":{"version":3,"names":["useEffect","useRef","useChessSocket","roomId","onMove","_s","wsRef","socket","WebSocket","current","onopen","console","log","send","JSON","stringify","type","room","onmessage","event","data","parse","fen","alert","msg","onclose","close","sendMove","move","readyState","OPEN"],"sources":["C:/Users/User/PycharmProjects/Chess/fe/src/components/useChessSocket.ts"],"sourcesContent":["import { useEffect, useRef } from \"react\";\n\ntype MoveCallback = (fen: string) => void;\n\nexport const useChessSocket = (roomId: string, onMove: MoveCallback) => {\n  const wsRef = useRef<WebSocket | null>(null);\n\n  useEffect(() => {\n    const socket = new WebSocket(\"ws://localhost:8765\"); // đổi thành IP server trong LAN nếu cần\n    wsRef.current = socket;\n\n    socket.onopen = () => {\n      console.log(\"Connected to server\");\n      socket.send(JSON.stringify({ type: \"join\", room: roomId }));\n    };\n\n    socket.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      if (data.type === \"state\" || data.type === \"move\") {\n        if (data.fen) onMove(data.fen);\n      } else if (data.type === \"error\") {\n        alert(data.msg);\n      }\n    };\n\n    socket.onclose = () => console.log(\"Disconnected\");\n\n    return () => socket.close();\n  }, [roomId, onMove]);\n\n  const sendMove = (move: string) => {\n    if (wsRef.current && wsRef.current.readyState === WebSocket.OPEN) {\n      wsRef.current.send(JSON.stringify({ type: \"move\", room: roomId, move }));\n    }\n  };\n\n  return { sendMove };\n};\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAIzC,OAAO,MAAMC,cAAc,GAAGA,CAACC,MAAc,EAAEC,MAAoB,KAAK;EAAAC,EAAA;EACtE,MAAMC,KAAK,GAAGL,MAAM,CAAmB,IAAI,CAAC;EAE5CD,SAAS,CAAC,MAAM;IACd,MAAMO,MAAM,GAAG,IAAIC,SAAS,CAAC,qBAAqB,CAAC,CAAC,CAAC;IACrDF,KAAK,CAACG,OAAO,GAAGF,MAAM;IAEtBA,MAAM,CAACG,MAAM,GAAG,MAAM;MACpBC,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;MAClCL,MAAM,CAACM,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC;QAAEC,IAAI,EAAE,MAAM;QAAEC,IAAI,EAAEd;MAAO,CAAC,CAAC,CAAC;IAC7D,CAAC;IAEDI,MAAM,CAACW,SAAS,GAAIC,KAAK,IAAK;MAC5B,MAAMC,IAAI,GAAGN,IAAI,CAACO,KAAK,CAACF,KAAK,CAACC,IAAI,CAAC;MACnC,IAAIA,IAAI,CAACJ,IAAI,KAAK,OAAO,IAAII,IAAI,CAACJ,IAAI,KAAK,MAAM,EAAE;QACjD,IAAII,IAAI,CAACE,GAAG,EAAElB,MAAM,CAACgB,IAAI,CAACE,GAAG,CAAC;MAChC,CAAC,MAAM,IAAIF,IAAI,CAACJ,IAAI,KAAK,OAAO,EAAE;QAChCO,KAAK,CAACH,IAAI,CAACI,GAAG,CAAC;MACjB;IACF,CAAC;IAEDjB,MAAM,CAACkB,OAAO,GAAG,MAAMd,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;IAElD,OAAO,MAAML,MAAM,CAACmB,KAAK,CAAC,CAAC;EAC7B,CAAC,EAAE,CAACvB,MAAM,EAAEC,MAAM,CAAC,CAAC;EAEpB,MAAMuB,QAAQ,GAAIC,IAAY,IAAK;IACjC,IAAItB,KAAK,CAACG,OAAO,IAAIH,KAAK,CAACG,OAAO,CAACoB,UAAU,KAAKrB,SAAS,CAACsB,IAAI,EAAE;MAChExB,KAAK,CAACG,OAAO,CAACI,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC;QAAEC,IAAI,EAAE,MAAM;QAAEC,IAAI,EAAEd,MAAM;QAAEyB;MAAK,CAAC,CAAC,CAAC;IAC1E;EACF,CAAC;EAED,OAAO;IAAED;EAAS,CAAC;AACrB,CAAC;AAACtB,EAAA,CAjCWH,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}