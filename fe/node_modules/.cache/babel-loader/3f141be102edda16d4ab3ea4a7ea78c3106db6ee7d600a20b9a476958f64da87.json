{"ast":null,"code":"// chessRules.ts (phiên bản multiplayer)\nexport function isValidMove(piece,r1,c1,r2,c2,board){const target=board[r2][c2];// Không ăn quân cùng màu\nif(piece===piece.toUpperCase()&&target!==\".\"&&target===target.toUpperCase())return false;if(piece===piece.toLowerCase()&&target!==\".\"&&target===target.toLowerCase())return false;const dr=r2-r1;const dc=c2-c1;switch(piece.toLowerCase()){case\"p\":{const direction=piece===\"P\"?-1:1;const startRow=piece===\"P\"?6:1;if(c1===c2&&dr===direction&&target===\".\")return true;if(c1===c2&&r1===startRow&&dr===2*direction&&board[r1+direction][c1]===\".\"&&board[r2][c2]===\".\")return true;if(Math.abs(dc)===1&&dr===direction&&target!==\".\")return true;return false;}case\"r\":{if(r1===r2){const min=Math.min(c1,c2)+1;const max=Math.max(c1,c2);for(let c=min;c<max;c++)if(board[r1][c]!==\".\")return false;return true;}else if(c1===c2){const min=Math.min(r1,r2)+1;const max=Math.max(r1,r2);for(let r=min;r<max;r++)if(board[r][c1]!==\".\")return false;return true;}return false;}case\"n\":return Math.abs(dr)===2&&Math.abs(dc)===1||Math.abs(dr)===1&&Math.abs(dc)===2;case\"b\":if(Math.abs(dr)!==Math.abs(dc))return false;const stepR=dr>0?1:-1;const stepC=dc>0?1:-1;let r=r1+stepR,c=c1+stepC;while(r!==r2&&c!==c2){if(board[r][c]!==\".\")return false;r+=stepR;c+=stepC;}return true;case\"q\":// Dùng rook + bishop logic\nreturn isValidMove(piece===\"Q\"?\"R\":\"r\",r1,c1,r2,c2,board)||isValidMove(piece===\"Q\"?\"B\":\"b\",r1,c1,r2,c2,board);case\"k\":// Chỉ cho di chuyển 1 ô\nreturn Math.abs(dr)<=1&&Math.abs(dc)<=1;default:return false;}}","map":{"version":3,"names":["isValidMove","piece","r1","c1","r2","c2","board","target","toUpperCase","toLowerCase","dr","dc","direction","startRow","Math","abs","min","max","c","r","stepR","stepC"],"sources":["C:/Users/User/PycharmProjects/Chess/fe/src/components/chessRules.ts"],"sourcesContent":["// chessRules.ts (phiên bản multiplayer)\nexport function isValidMove(\n  piece: string,\n  r1: number,\n  c1: number,\n  r2: number,\n  c2: number,\n  board: string[][]\n): boolean {\n  const target = board[r2][c2];\n\n  // Không ăn quân cùng màu\n  if (piece === piece.toUpperCase() && target !== \".\" && target === target.toUpperCase()) return false;\n  if (piece === piece.toLowerCase() && target !== \".\" && target === target.toLowerCase()) return false;\n\n  const dr = r2 - r1;\n  const dc = c2 - c1;\n\n  switch (piece.toLowerCase()) {\n    case \"p\": {\n      const direction = piece === \"P\" ? -1 : 1;\n      const startRow = piece === \"P\" ? 6 : 1;\n      if (c1 === c2 && dr === direction && target === \".\") return true;\n      if (c1 === c2 && r1 === startRow && dr === 2 * direction && board[r1 + direction][c1] === \".\" && board[r2][c2] === \".\") return true;\n      if (Math.abs(dc) === 1 && dr === direction && target !== \".\") return true;\n      return false;\n    }\n    case \"r\": {\n      if (r1 === r2) {\n        const min = Math.min(c1, c2) + 1;\n        const max = Math.max(c1, c2);\n        for (let c = min; c < max; c++) if (board[r1][c] !== \".\") return false;\n        return true;\n      } else if (c1 === c2) {\n        const min = Math.min(r1, r2) + 1;\n        const max = Math.max(r1, r2);\n        for (let r = min; r < max; r++) if (board[r][c1] !== \".\") return false;\n        return true;\n      }\n      return false;\n    }\n    case \"n\":\n      return (Math.abs(dr) === 2 && Math.abs(dc) === 1) || (Math.abs(dr) === 1 && Math.abs(dc) === 2);\n    case \"b\":\n      if (Math.abs(dr) !== Math.abs(dc)) return false;\n      const stepR = dr > 0 ? 1 : -1;\n      const stepC = dc > 0 ? 1 : -1;\n      let r = r1 + stepR, c = c1 + stepC;\n      while (r !== r2 && c !== c2) {\n        if (board[r][c] !== \".\") return false;\n        r += stepR; c += stepC;\n      }\n      return true;\n    case \"q\":\n      // Dùng rook + bishop logic\n      return isValidMove(piece === \"Q\" ? \"R\" : \"r\", r1, c1, r2, c2, board) ||\n             isValidMove(piece === \"Q\" ? \"B\" : \"b\", r1, c1, r2, c2, board);\n    case \"k\":\n      // Chỉ cho di chuyển 1 ô\n      return Math.abs(dr) <= 1 && Math.abs(dc) <= 1;\n    default:\n      return false;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}