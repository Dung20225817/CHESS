{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\PycharmProjects\\\\Chess\\\\fe\\\\src\\\\components\\\\Board.tsx\",\n  _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport Square from \"./Square\";\nimport { useChessSocket } from \"./useChessSocket\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst pieceImages = {/* như trước */};\nconst initialBoard = [/* như trước */];\nconst Board = ({\n  roomId\n}) => {\n  _s();\n  const [board, setBoard] = useState(initialBoard.map(r => r.split(\"\")));\n  const [selected, setSelected] = useState(null);\n  const [validMoves, setValidMoves] = useState([]);\n  const [turn, setTurn] = useState(\"white\");\n  const {\n    sendMove,\n    playerColor\n  } = useChessSocket(roomId, (fen, turn) => {\n    const rows = fen.split(\" \")[0].split(\"/\").map(r => r.split(\"\").flatMap(c => isNaN(+c) ? [c] : Array(+c).fill(\".\")));\n    setBoard(rows);\n    setTurn(turn);\n  });\n  const handleClick = (r, c) => {\n    if (playerColor !== turn) return; // không phải lượt mình\n    const piece = board[r][c];\n    if (!selected) {\n      if (piece !== \".\" && (piece.toUpperCase() === piece ? \"white\" : \"black\") === turn) {\n        setSelected([r, c]);\n        // tính moves hợp lệ (giống trước)\n      }\n      return;\n    }\n    const [r1, c1] = selected;\n    if (validMoves.some(([x, y]) => x === r && y === c)) {\n      const moveUCI = `${String.fromCharCode(97 + c1)}${8 - r1}${String.fromCharCode(97 + c)}${8 - r}`;\n      sendMove(moveUCI);\n    }\n    setSelected(null);\n    setValidMoves([]);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"grid\",\n      gridTemplateColumns: \"repeat(8, 60px)\",\n      gridTemplateRows: \"repeat(8, 60px)\",\n      border: \"2px solid black\"\n    },\n    children: board.map((row, i) => row.map((piece, j) => {\n      const color = (i + j) % 2 === 0 ? \"#f0d9b5\" : \"#b58863\";\n      const isSelected = (selected === null || selected === void 0 ? void 0 : selected[0]) === i && (selected === null || selected === void 0 ? void 0 : selected[1]) === j;\n      const isValid = validMoves.some(([x, y]) => x === i && y === j);\n      const bgColor = isSelected ? \"yellow\" : isValid ? \"#a0d8ff\" : color;\n      return /*#__PURE__*/_jsxDEV(Square, {\n        value: pieceImages[piece] || \"\",\n        isSelected: isSelected,\n        onClick: () => handleClick(i, j),\n        color: bgColor\n      }, `${i}-${j}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 18\n      }, this);\n    }))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 42,\n    columnNumber: 5\n  }, this);\n};\n_s(Board, \"3U6yKAfgZDmv+1oRaHwo4A3umAw=\", false, function () {\n  return [useChessSocket];\n});\n_c = Board;\nexport default Board;\nvar _c;\n$RefreshReg$(_c, \"Board\");","map":{"version":3,"names":["useState","Square","useChessSocket","jsxDEV","_jsxDEV","pieceImages","initialBoard","Board","roomId","_s","board","setBoard","map","r","split","selected","setSelected","validMoves","setValidMoves","turn","setTurn","sendMove","playerColor","fen","rows","flatMap","c","isNaN","Array","fill","handleClick","piece","toUpperCase","r1","c1","some","x","y","moveUCI","String","fromCharCode","style","display","gridTemplateColumns","gridTemplateRows","border","children","row","i","j","color","isSelected","isValid","bgColor","value","onClick","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/User/PycharmProjects/Chess/fe/src/components/Board.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport Square from \"./Square\";\nimport { isValidMove, KingMoved, RookMoved } from \"./chessRules\";\nimport { useChessSocket } from \"./useChessSocket\";\n\nconst pieceImages = { /* như trước */ };\nconst initialBoard = [ /* như trước */ ];\n\nconst Board: React.FC<{ roomId: string }> = ({ roomId }) => {\n  const [board, setBoard] = useState<string[][]>(initialBoard.map(r => r.split(\"\")));\n  const [selected, setSelected] = useState<[number, number] | null>(null);\n  const [validMoves, setValidMoves] = useState<[number, number][]>([]);\n  const [turn, setTurn] = useState<\"white\" | \"black\">(\"white\");\n  const { sendMove, playerColor } = useChessSocket(roomId, (fen, turn) => {\n    const rows = fen.split(\" \")[0].split(\"/\").map(r =>\n      r.split(\"\").flatMap(c => isNaN(+c) ? [c] : Array(+c).fill(\".\"))\n    );\n    setBoard(rows as string[][]);\n    setTurn(turn);\n  });\n\n  const handleClick = (r: number, c: number) => {\n    if (playerColor !== turn) return; // không phải lượt mình\n    const piece = board[r][c];\n    if (!selected) {\n      if (piece !== \".\" && (piece.toUpperCase() === piece ? \"white\" : \"black\") === turn) {\n        setSelected([r, c]);\n        // tính moves hợp lệ (giống trước)\n      }\n      return;\n    }\n    const [r1, c1] = selected;\n    if (validMoves.some(([x, y]) => x === r && y === c)) {\n      const moveUCI = `${String.fromCharCode(97 + c1)}${8 - r1}${String.fromCharCode(97 + c)}${8 - r}`;\n      sendMove(moveUCI);\n    }\n    setSelected(null);\n    setValidMoves([]);\n  };\n\n  return (\n    <div style={{ display: \"grid\", gridTemplateColumns: \"repeat(8, 60px)\", gridTemplateRows: \"repeat(8, 60px)\", border: \"2px solid black\" }}>\n      {board.map((row, i) =>\n        row.map((piece, j) => {\n          const color = (i + j) % 2 === 0 ? \"#f0d9b5\" : \"#b58863\";\n          const isSelected = selected?.[0] === i && selected?.[1] === j;\n          const isValid = validMoves.some(([x, y]) => x === i && y === j);\n          const bgColor = isSelected ? \"yellow\" : isValid ? \"#a0d8ff\" : color;\n          return <Square key={`${i}-${j}`} value={pieceImages[piece] || \"\"} isSelected={isSelected} onClick={() => handleClick(i, j)} color={bgColor} />;\n        })\n      )}\n    </div>\n  );\n};\n\nexport default Board;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}